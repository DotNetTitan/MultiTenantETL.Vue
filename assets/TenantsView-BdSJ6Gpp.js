import{j as ee,r as u,o as te,c as ae,a as z,b as t,d as r,w as l,v as le,e as E,f as d,g as P,t as C,k as ne}from"./index-DvHs-uuO.js";const oe={class:"d-flex align-center mb-4"},re={__name:"TenantsView",setup(ie){const q=ee(),J=[{title:"Name",key:"name"},{title:"Identifier",key:"identifier"},{title:"Description",key:"description"},{title:"Status",key:"status",width:"120px"},{title:"Created",key:"createdAt",width:"150px"},{title:"Contact",key:"contactName"},{title:"Actions",key:"actions",sortable:!1,width:"120px",align:"end"}],y=u(""),A=u("All"),x=u("name_asc"),j=u([{title:"All Statuses",value:"All"},{title:"Active",value:"Active"},{title:"Inactive",value:"Inactive"}]),M=u([{title:"Name (A-Z)",value:"name_asc"},{title:"Name (Z-A)",value:"name_desc"},{title:"Created (Newest)",value:"created_desc"},{title:"Created (Oldest)",value:"created_asc"}]),m=u([]),p=u(!1),k=u(!1),S=u(!1),v=u(!1),_=u(!1),g=u(null),F=u(null),i=u(I());function I(){return{id:null,name:"",identifier:"",description:"",contactName:"",contactEmail:"",isActive:!0}}function Z(n){return n?new Date(n).toLocaleString():"-"}async function b(){try{p.value=!0;const n=await le.get("/api/tenants");if(await new Promise(o=>setTimeout(o,500)),m.value=[{id:"1",name:"Acme Corporation",identifier:"acme",description:"A multinational company producing various products",contactName:"John Smith",contactEmail:"john.smith@acme.com",isActive:!0,createdAt:new Date(Date.now()-100*24*60*60*1e3).toISOString()},{id:"2",name:"Globex Corporation",identifier:"globex",description:"Electronics manufacturing company",contactName:"Jane Doe",contactEmail:"jane.doe@globex.com",isActive:!0,createdAt:new Date(Date.now()-80*24*60*60*1e3).toISOString()},{id:"3",name:"Soylent Corp",identifier:"soylent",description:"Food production company",contactName:"Bob Johnson",contactEmail:"bob.johnson@soylent.com",isActive:!1,createdAt:new Date(Date.now()-60*24*60*60*1e3).toISOString()},{id:"4",name:"Initech",identifier:"initech",description:"Software company specializing in finance",contactName:"Michael Bolton",contactEmail:"michael.bolton@initech.com",isActive:!0,createdAt:new Date(Date.now()-40*24*60*60*1e3).toISOString()},{id:"5",name:"Umbrella Corporation",identifier:"umbrella",description:"Pharmaceutical company",contactName:"Albert Wesker",contactEmail:"albert.wesker@umbrella.com",isActive:!0,createdAt:new Date(Date.now()-20*24*60*60*1e3).toISOString()}],y.value){const o=y.value.toLowerCase();m.value=m.value.filter(s=>s.name.toLowerCase().includes(o)||s.identifier.toLowerCase().includes(o)||s.description.toLowerCase().includes(o)||s.contactName&&s.contactName.toLowerCase().includes(o)||s.contactEmail&&s.contactEmail.toLowerCase().includes(o))}if(A.value!=="All"){const o=A.value==="Active";m.value=m.value.filter(s=>s.isActive===o)}const[e,w]=x.value.split("_");m.value.sort((o,s)=>{let c=o[e],f=s[e];return e==="created"&&(c=new Date(o.createdAt).getTime(),f=new Date(s.createdAt).getTime()),w==="asc"?c>f?1:-1:c<f?1:-1})}catch(n){console.error("Error fetching tenants:",n)}finally{p.value=!1}}function G(n){i.value=JSON.parse(JSON.stringify(n)),v.value=!0}async function U(n){try{p.value=!0,await new Promise(e=>setTimeout(e,500)),n.isActive=!n.isActive}catch(e){console.error("Error toggling tenant status:",e)}finally{p.value=!1}}function W(n){g.value=n,_.value=!0}async function H(){try{S.value=!0,await new Promise(e=>setTimeout(e,1e3));const n=m.value.findIndex(e=>e.id===g.value.id);n!==-1&&m.value.splice(n,1),_.value=!1,g.value=null}catch(n){console.error("Error deleting tenant:",n)}finally{S.value=!1}}async function O(){try{k.value=!0,await new Promise(e=>setTimeout(e,1e3)),i.value.id||(i.value.id=Math.random().toString(36).substring(2,15),i.value.createdAt=new Date().toISOString());const n=m.value.findIndex(e=>e.id===i.value.id);n!==-1?m.value[n]={...i.value}:m.value.push({...i.value}),v.value=!1,i.value=I()}catch(n){console.error("Error saving tenant:",n)}finally{k.value=!1}}return te(async()=>{if(!q.isAdmin){router.push("/");return}await b()}),(n,e)=>{const w=r("v-spacer"),o=r("v-btn"),s=r("v-text-field"),c=r("v-col"),f=r("v-select"),h=r("v-row"),K=r("v-chip"),V=r("v-icon"),Q=r("v-data-table"),D=r("v-card-text"),T=r("v-card"),B=r("v-card-title"),R=r("v-textarea"),X=r("v-switch"),Y=r("v-form"),L=r("v-card-actions"),$=r("v-dialog");return E(),ae("div",null,[z("div",oe,[e[15]||(e[15]=z("h1",{class:"text-h4 mr-4"},"Tenants",-1)),t(w),t(o,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=a=>v.value=!0)},{default:l(()=>e[14]||(e[14]=[d(" Create Tenant ")])),_:1})]),t(T,null,{default:l(()=>[t(D,null,{default:l(()=>[t(h,null,{default:l(()=>[t(c,{cols:"12",md:"4"},{default:l(()=>[t(s,{modelValue:y.value,"onUpdate:modelValue":[e[1]||(e[1]=a=>y.value=a),b],label:"Search Tenants","prepend-inner-icon":"mdi-magnify",density:"compact","hide-details":"",class:"mb-4"},null,8,["modelValue"])]),_:1}),t(c,{cols:"12",md:"3"},{default:l(()=>[t(f,{modelValue:A.value,"onUpdate:modelValue":[e[2]||(e[2]=a=>A.value=a),b],label:"Status",items:j.value,density:"compact","hide-details":"",class:"mb-4"},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"12",md:"3"},{default:l(()=>[t(f,{modelValue:x.value,"onUpdate:modelValue":[e[3]||(e[3]=a=>x.value=a),b],label:"Sort By",items:M.value,density:"compact","hide-details":"",class:"mb-4"},null,8,["modelValue","items"])]),_:1})]),_:1}),t(Q,{headers:J,items:m.value,loading:p.value,"items-per-page":10,class:"mt-2"},{"item.status":l(({item:a})=>[t(K,{color:a.isActive?"success":"error","text-color":"white",size:"small"},{default:l(()=>[d(C(a.isActive?"Active":"Inactive"),1)]),_:2},1032,["color"])]),"item.createdAt":l(({item:a})=>[d(C(Z(a.createdAt)),1)]),"item.actions":l(({item:a})=>[t(o,{icon:"",variant:"text",size:"small",onClick:N=>G(a),title:"Edit tenant"},{default:l(()=>[t(V,null,{default:l(()=>e[16]||(e[16]=[d("mdi-pencil")])),_:1})]),_:2},1032,["onClick"]),a.isActive?(E(),P(o,{key:1,icon:"",variant:"text",size:"small",color:"warning",onClick:N=>U(a),title:"Deactivate tenant"},{default:l(()=>[t(V,null,{default:l(()=>e[18]||(e[18]=[d("mdi-close")])),_:1})]),_:2},1032,["onClick"])):(E(),P(o,{key:0,icon:"",variant:"text",size:"small",color:"success",onClick:N=>U(a),title:"Activate tenant"},{default:l(()=>[t(V,null,{default:l(()=>e[17]||(e[17]=[d("mdi-check")])),_:1})]),_:2},1032,["onClick"])),t(o,{icon:"",variant:"text",size:"small",color:"error",onClick:N=>W(a),title:"Delete tenant",disabled:a.isActive},{default:l(()=>[t(V,null,{default:l(()=>e[19]||(e[19]=[d("mdi-delete")])),_:1})]),_:2},1032,["onClick","disabled"])]),_:1},8,["items","loading"])]),_:1})]),_:1}),t($,{modelValue:v.value,"onUpdate:modelValue":e[11]||(e[11]=a=>v.value=a),"max-width":"600px",persistent:""},{default:l(()=>[t(T,null,{default:l(()=>[t(B,null,{default:l(()=>[d(C(i.value.id?"Edit Tenant":"Create Tenant"),1)]),_:1}),t(D,null,{default:l(()=>[t(Y,{ref_key:"form",ref:F,onSubmit:ne(O,["prevent"])},{default:l(()=>[t(h,null,{default:l(()=>[t(c,{cols:"12"},{default:l(()=>[t(s,{modelValue:i.value.name,"onUpdate:modelValue":e[4]||(e[4]=a=>i.value.name=a),label:"Tenant Name",required:"",rules:[a=>!!a||"Name is required"]},null,8,["modelValue","rules"])]),_:1}),t(c,{cols:"12"},{default:l(()=>[t(s,{modelValue:i.value.identifier,"onUpdate:modelValue":e[5]||(e[5]=a=>i.value.identifier=a),label:"Identifier",required:"",rules:[a=>!!a||"Identifier is required",a=>/^[a-z0-9-]+$/.test(a)||"Identifier can only contain lowercase letters, numbers, and hyphens"],hint:"Used as subdomain and in API requests","persistent-hint":""},null,8,["modelValue","rules"])]),_:1}),t(c,{cols:"12"},{default:l(()=>[t(R,{modelValue:i.value.description,"onUpdate:modelValue":e[6]||(e[6]=a=>i.value.description=a),label:"Description",rows:"2"},null,8,["modelValue"])]),_:1}),t(c,{cols:"12",md:"6"},{default:l(()=>[t(s,{modelValue:i.value.contactName,"onUpdate:modelValue":e[7]||(e[7]=a=>i.value.contactName=a),label:"Contact Name"},null,8,["modelValue"])]),_:1}),t(c,{cols:"12",md:"6"},{default:l(()=>[t(s,{modelValue:i.value.contactEmail,"onUpdate:modelValue":e[8]||(e[8]=a=>i.value.contactEmail=a),label:"Contact Email",rules:[a=>!a||/.+@.+\..+/.test(a)||"Email must be valid"]},null,8,["modelValue","rules"])]),_:1}),t(c,{cols:"12"},{default:l(()=>[t(X,{modelValue:i.value.isActive,"onUpdate:modelValue":e[9]||(e[9]=a=>i.value.isActive=a),label:"Active",color:"success","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),t(L,null,{default:l(()=>[t(w),t(o,{variant:"text",onClick:e[10]||(e[10]=a=>v.value=!1)},{default:l(()=>e[20]||(e[20]=[d(" Cancel ")])),_:1}),t(o,{color:"primary",onClick:O,loading:k.value},{default:l(()=>e[21]||(e[21]=[d(" Save ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t($,{modelValue:_.value,"onUpdate:modelValue":e[13]||(e[13]=a=>_.value=a),"max-width":"400px"},{default:l(()=>[t(T,null,{default:l(()=>[t(B,{class:"text-h5"},{default:l(()=>e[22]||(e[22]=[d(" Delete Tenant ")])),_:1}),t(D,null,{default:l(()=>{var a;return[d(' Are you sure you want to delete the tenant "'+C((a=g.value)==null?void 0:a.name)+'"? This action cannot be undone and all associated data will be permanently deleted. ',1)]}),_:1}),t(L,null,{default:l(()=>[t(w),t(o,{variant:"text",onClick:e[12]||(e[12]=a=>_.value=!1)},{default:l(()=>e[23]||(e[23]=[d(" Cancel ")])),_:1}),t(o,{color:"error",onClick:H,loading:S.value},{default:l(()=>e[24]||(e[24]=[d(" Delete ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{re as default};
