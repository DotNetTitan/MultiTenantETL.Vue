import{_ as xe,u as be,x as ye,r as p,o as Te,p as Ce,c as $,a as d,b as l,d as r,w as t,e as b,f as a,g as L,h as M,t as m,l as Se,F as De,i as ke}from"./index-DvHs-uuO.js";const Ee={class:"d-flex align-center mb-4"},Le={class:"text-h5 font-weight-bold text-white mb-1"},Pe={class:"d-flex align-center"},Ie={class:"text-white text-subtitle-2"},Ve={class:"my-3"},he={class:"d-flex justify-space-between mb-1"},Ae={class:"text-body-2"},Fe={class:"d-flex align-center mb-2"},Ne={class:"text-h4 ml-8"},Re={class:"d-flex align-center justify-space-between mt-3"},Oe={class:"text-caption"},ze={class:"d-flex align-center mb-3"},$e={class:"logs-content"},Me={class:"d-flex align-center mb-3"},Ue={key:0,class:"text-center pa-4"},Be={key:1,class:"timeline-scrollable-container custom-scrollbar"},je={class:"text-caption text-grey timeline-time"},Qe={class:"timeline-title"},We={class:"text-body-2 timeline-description"},He={__name:"ExecutionsView",setup(Ye){const q=be(),ee=ye(),te=[{title:"Pipeline",key:"pipelineName"},{title:"Status",key:"status",width:"120px"},{title:"Start Time",key:"startTime",width:"150px"},{title:"End Time",key:"endTime",width:"150px"},{title:"Duration",key:"duration",width:"100px"},{title:"Rows Processed",key:"rowsProcessed",width:"120px"},{title:"Actions",key:"actions",sortable:!1,width:"100px",align:"end"}],P=p(""),I=p("All"),U=p("24h"),le=p([{title:"All Statuses",value:"All"},{title:"Running",value:"Running"},{title:"Completed",value:"Completed"},{title:"Failed",value:"Failed"},{title:"Cancelled",value:"Cancelled"}]),ne=p([{title:"Last 24 Hours",value:"24h"},{title:"Last 7 Days",value:"7d"},{title:"Last 30 Days",value:"30d"},{title:"All Time",value:"all"}]),D=p([]),V=p(!1),B=p(!1),k=p(!1),C=p(!1),i=p(null),j=p(null),Q=p(null),h=p("overview");function oe(n){switch(n==null?void 0:n.toLowerCase()){case"completed":return"mdi-check-circle";case"running":return"mdi-circle-slice-8";case"failed":return"mdi-alert-circle";case"cancelled":return"mdi-stop-circle";default:return"mdi-help-circle"}}function ae(){var n;(n=i.value)!=null&&n.logs&&navigator.clipboard.writeText(i.value.logs).then(()=>{console.log("Logs copied to clipboard")}).catch(e=>{console.error("Failed to copy logs: ",e)})}function ie(n){switch(n==null?void 0:n.toLowerCase()){case"completed":return"green-darken-1";case"running":return"blue-darken-1";case"failed":return"red-darken-1";case"cancelled":return"amber-darken-1";default:return"grey-darken-1"}}function se(n){try{const e=n.match(/\d{2}:\d{2}:\d{2}/);return e?e[0]:n}catch{return n}}function G(){if(!i.value||!i.value.logs)return[];const e=(i.value.logs||"").split(`
`),u=[];return e.forEach(s=>{if(!s.trim())return;const g=s.match(/\[(.*?)\]\s*(.*)/);if(g){const T=g[1],f=g[2];let _="primary",v="mdi-information",c=!1;f.toLowerCase().includes("starting")?(_="blue",v="mdi-play-circle",c=!0):f.toLowerCase().includes("extracted")?(_="cyan",v="mdi-database-export"):f.toLowerCase().includes("transformation")?(_="purple",v="mdi-autorenew"):f.toLowerCase().includes("loading")?(_="indigo",v="mdi-database-import"):f.toLowerCase().includes("successfully")?(_="success",v="mdi-check-circle",c=!0):f.toLowerCase().includes("error")||f.toLowerCase().includes("fail")?(_="error",v="mdi-alert-circle",c=!0):f.toLowerCase().includes("cancelled")?(_="warning",v="mdi-stop-circle",c=!0):f.toLowerCase().includes("processing batch")&&(_="teal",v="mdi-buffer");let F=f,w="";if(f.includes(":")){const x=f.split(":");F=x[0].trim(),w=x.slice(1).join(":").trim()}u.push({time:T,title:F,description:w,color:_,icon:v,important:c})}}),u}function E(n){switch(n==null?void 0:n.toLowerCase()){case"completed":return"success";case"running":return"info";case"failed":return"error";case"cancelled":return"warning";default:return"grey"}}function A(n,e=!1){if(!n)return"-";const u=new Date(n);return e?u.toLocaleString():u.toLocaleDateString()+" "+u.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function J(n){if(!n)return"-";const e=Math.floor(n/1e3);if(e<60)return`${e}s`;const u=Math.floor(e/60);return u<60?`${u}m ${e%60}s`:`${Math.floor(u/60)}h ${u%60}m`}function re(){const n=new Date;switch(U.value){case"24h":return new Date(n.getTime()-24*60*60*1e3);case"7d":return new Date(n.getTime()-7*24*60*60*1e3);case"30d":return new Date(n.getTime()-30*24*60*60*1e3);case"all":default:return null}}async function y(){try{V.value=!0,await new Promise(s=>setTimeout(s,500));const n=re();let u=[...[{id:"1",pipelineId:"1",pipelineName:"Sales Data ETL",status:"Completed",startTime:new Date(Date.now()-2*60*60*1e3).toISOString(),endTime:new Date(Date.now()-1.9*60*60*1e3).toISOString(),duration:36e4,rowsProcessed:12345,logs:`[2025-03-14 22:15:01] Starting extraction from source: SQL Server - Sales
[2025-03-14 22:15:03] Extracted 12345 rows from source
[2025-03-14 22:15:05] Applying 3 transformations
[2025-03-14 22:15:06] Applying transformation: Filter Inactive Customers
[2025-03-14 22:15:07] Applying transformation: Map Customer Segments
[2025-03-14 22:15:08] Applying transformation: Format Phone Numbers
[2025-03-14 22:15:09] Loading data to destination: Data Warehouse
[2025-03-14 22:15:11] Successfully loaded 12345 rows to destination`,progressPercent:100},{id:"2",pipelineId:"2",pipelineName:"Customer Import",status:"Failed",startTime:new Date(Date.now()-12*60*60*1e3).toISOString(),endTime:new Date(Date.now()-11.9*60*60*1e3).toISOString(),duration:18e4,rowsProcessed:0,logs:`[2025-03-14 12:30:01] Starting extraction from source: SFTP - Customer Files
[2025-03-14 12:30:05] Error: Failed to connect to SFTP server. Connection refused.
[2025-03-14 12:30:05] Execution failed: Failed to connect to SFTP server`,progressPercent:0},{id:"3",pipelineId:"3",pipelineName:"Product Sync",status:"Running",startTime:new Date(Date.now()-5*60*1e3).toISOString(),endTime:null,duration:Date.now()-new Date(Date.now()-5*60*1e3).getTime(),rowsProcessed:3200,logs:`[2025-03-14 23:45:01] Starting extraction from source: ERP API
[2025-03-14 23:45:03] Extracted 5000 rows from source
[2025-03-14 23:45:08] Applying transformations
[2025-03-14 23:45:10] Loading data to destination: E-commerce Platform
[2025-03-14 23:45:16] Processing batch...`,progressPercent:60},{id:"4",pipelineId:"4",pipelineName:"Analytics Export",status:"Cancelled",startTime:new Date(Date.now()-24*60*60*1e3).toISOString(),endTime:new Date(Date.now()-23.9*60*60*1e3).toISOString(),duration:24e4,rowsProcessed:1500,logs:`[2025-03-13 23:50:01] Starting extraction from source: Analytics DB
[2025-03-13 23:50:04] Extracted 5000 rows from source
[2025-03-13 23:50:06] Applying 1 transformation
[2025-03-13 23:50:08] Applying transformation: Aggregate Daily Metrics
[2025-03-13 23:50:12] Execution was cancelled`,progressPercent:30},{id:"5",pipelineId:"1",pipelineName:"Sales Data ETL",status:"Completed",startTime:new Date(Date.now()-26*60*60*1e3).toISOString(),endTime:new Date(Date.now()-25.9*60*60*1e3).toISOString(),duration:3e5,rowsProcessed:10200,logs:`[2025-03-13 00:15:01] Starting extraction from source: SQL Server - Sales
[2025-03-13 00:15:03] Extracted 10200 rows from source
[2025-03-13 00:15:05] Applying 3 transformations
[2025-03-13 00:15:06] Applying transformation: Filter Inactive Customers
[2025-03-13 00:15:07] Applying transformation: Map Customer Segments
[2025-03-13 00:15:08] Applying transformation: Format Phone Numbers
[2025-03-13 00:15:09] Loading data to destination: Data Warehouse
[2025-03-13 00:15:11] Successfully loaded 10200 rows to destination`,progressPercent:100}]];if(n&&(u=u.filter(s=>new Date(s.startTime)>=n)),I.value!=="All"&&(u=u.filter(s=>s.status===I.value)),P.value){const s=P.value.toLowerCase();u=u.filter(g=>g.pipelineName.toLowerCase().includes(s)||g.id.toLowerCase().includes(s))}if(u.sort((s,g)=>new Date(g.startTime)-new Date(s.startTime)),D.value=u,D.value.forEach(s=>{s.status==="Running"&&(s.duration=Date.now()-new Date(s.startTime).getTime())}),i.value){const s=D.value.find(g=>g.id===i.value.id);s&&(i.value={...s})}}catch(n){console.error("Error fetching executions:",n)}finally{V.value=!1}}function ue(n){i.value={...n},k.value=!0}function K(n){j.value=n,C.value=!0}async function de(){try{B.value=!0,await new Promise(e=>setTimeout(e,1e3));const n=D.value.find(e=>e.id===j.value.id);n&&(n.status="Cancelled",n.endTime=new Date().toISOString(),i.value&&i.value.id===n.id&&(i.value={...n})),C.value=!1,j.value=null}catch(n){console.error("Error cancelling execution:",n)}finally{B.value=!1}}return Te(()=>{y(),Q.value=setInterval(()=>{!k.value&&!C.value&&y()},5e3),q.$subscribe(()=>{q.currentTenantId&&y()})}),Ce(()=>{Q.value&&clearInterval(Q.value)}),(n,e)=>{const u=r("v-spacer"),s=r("v-btn"),g=r("v-text-field"),T=r("v-col"),f=r("v-select"),_=r("v-row"),v=r("v-chip"),c=r("v-icon"),F=r("v-data-table"),w=r("v-card-text"),x=r("v-card"),ce=r("v-avatar"),me=r("v-banner"),W=r("v-tab"),fe=r("v-tabs"),N=r("v-card-title"),R=r("v-list-item-title"),O=r("v-list-item-subtitle"),z=r("v-list-item"),S=r("v-divider"),pe=r("v-list"),ve=r("v-progress-linear"),H=r("v-window-item"),ge=r("v-timeline-item"),_e=r("v-timeline"),we=r("v-window"),X=r("v-card-actions"),Z=r("v-dialog");return b(),$("div",null,[d("div",Ee,[e[11]||(e[11]=d("h1",{class:"text-h4 mr-4"},"Pipeline Executions",-1)),l(u),l(s,{color:"primary","prepend-icon":"mdi-refresh",onClick:y,loading:V.value},{default:t(()=>e[10]||(e[10]=[a(" Refresh ")])),_:1},8,["loading"])]),l(x,null,{default:t(()=>[l(w,null,{default:t(()=>[l(_,null,{default:t(()=>[l(T,{cols:"12",md:"4"},{default:t(()=>[l(g,{modelValue:P.value,"onUpdate:modelValue":[e[0]||(e[0]=o=>P.value=o),y],label:"Search Executions","prepend-inner-icon":"mdi-magnify",density:"compact","hide-details":"",class:"mb-4"},null,8,["modelValue"])]),_:1}),l(T,{cols:"12",md:"3"},{default:t(()=>[l(f,{modelValue:I.value,"onUpdate:modelValue":[e[1]||(e[1]=o=>I.value=o),y],label:"Status",items:le.value,density:"compact","hide-details":"",class:"mb-4"},null,8,["modelValue","items"])]),_:1}),l(T,{cols:"12",md:"3"},{default:t(()=>[l(f,{modelValue:U.value,"onUpdate:modelValue":[e[2]||(e[2]=o=>U.value=o),y],label:"Time Range",items:ne.value,density:"compact","hide-details":"",class:"mb-4"},null,8,["modelValue","items"])]),_:1})]),_:1}),l(F,{headers:te,items:D.value,loading:V.value,"items-per-page":10,class:"mt-2"},{"item.status":t(({item:o})=>[l(v,{color:E(o.status),"text-color":"white",size:"small"},{default:t(()=>[a(m(o.status),1)]),_:2},1032,["color"])]),"item.startTime":t(({item:o})=>[a(m(A(o.startTime)),1)]),"item.endTime":t(({item:o})=>[a(m(o.endTime?A(o.endTime):"-"),1)]),"item.duration":t(({item:o})=>[a(m(J(o.duration)),1)]),"item.actions":t(({item:o})=>[l(s,{icon:"",variant:"text",size:"small",onClick:Y=>ue(o),title:"View details"},{default:t(()=>[l(c,null,{default:t(()=>e[12]||(e[12]=[a("mdi-eye")])),_:1})]),_:2},1032,["onClick"]),o.status==="Running"?(b(),L(s,{key:0,icon:"",variant:"text",size:"small",color:"error",onClick:Y=>K(o),title:"Cancel execution"},{default:t(()=>[l(c,null,{default:t(()=>e[13]||(e[13]=[a("mdi-stop")])),_:1})]),_:2},1032,["onClick"])):M("",!0)]),_:1},8,["items","loading"])]),_:1})]),_:1}),l(Z,{modelValue:k.value,"onUpdate:modelValue":e[7]||(e[7]=o=>k.value=o),"max-width":"950px"},{default:t(()=>[i.value?(b(),L(x,{key:0},{default:t(()=>[l(me,{color:E(i.value.status),class:"execution-header pa-4 pb-6",elevation:"1"},{prepend:t(()=>[l(ce,{class:"mr-3 status-avatar",size:"42"},{default:t(()=>[l(c,{icon:oe(i.value.status),color:"white",size:"28"},null,8,["icon"])]),_:1})]),actions:t(()=>[i.value.status==="Running"?(b(),L(s,{key:0,color:E(i.value.status),variant:"tonal",onClick:e[3]||(e[3]=o=>K(i.value)),class:"cancel-btn"},{default:t(()=>[l(c,{start:""},{default:t(()=>e[14]||(e[14]=[a("mdi-stop")])),_:1}),e[15]||(e[15]=a(" Cancel Execution "))]),_:1},8,["color"])):M("",!0)]),default:t(()=>[d("div",null,[d("h2",Le,m(i.value.pipelineName),1),d("div",Pe,[d("span",Ie,"Execution ID: "+m(i.value.id),1),l(v,{size:"small",class:"ml-4",color:ie(i.value.status),"text-color":"white"},{default:t(()=>[a(m(i.value.status),1)]),_:1},8,["color"])])])]),_:1},8,["color"]),l(fe,{modelValue:h.value,"onUpdate:modelValue":e[4]||(e[4]=o=>h.value=o),"bg-color":Se(ee).global.current.value.dark?"grey-darken-3":"grey-lighten-4",class:"execution-tabs"},{default:t(()=>[l(W,{value:"overview",class:"px-6"},{default:t(()=>e[16]||(e[16]=[a("Overview")])),_:1}),l(W,{value:"logs",class:"px-6"},{default:t(()=>e[17]||(e[17]=[a("Logs")])),_:1}),l(W,{value:"timeline",class:"px-6"},{default:t(()=>e[18]||(e[18]=[a("Timeline")])),_:1})]),_:1},8,["modelValue","bg-color"]),l(we,{modelValue:h.value,"onUpdate:modelValue":e[5]||(e[5]=o=>h.value=o)},{default:t(()=>[l(H,{value:"overview"},{default:t(()=>[l(w,null,{default:t(()=>[l(_,null,{default:t(()=>[l(T,{cols:"12",lg:"6"},{default:t(()=>[l(x,{variant:"outlined",class:"mb-4"},{default:t(()=>[l(N,{class:"text-subtitle-1 bg-grey-lighten-4"},{default:t(()=>[l(c,{start:""},{default:t(()=>e[19]||(e[19]=[a("mdi-information-outline")])),_:1}),e[20]||(e[20]=a(" Basic Information "))]),_:1}),l(w,null,{default:t(()=>[l(pe,{density:"compact",lines:"two"},{default:t(()=>[l(z,null,{prepend:t(()=>[l(c,{class:"mr-2"},{default:t(()=>e[21]||(e[21]=[a("mdi-pipeline")])),_:1})]),default:t(()=>[l(R,null,{default:t(()=>e[22]||(e[22]=[a("Pipeline")])),_:1}),l(O,null,{default:t(()=>[a(m(i.value.pipelineName),1)]),_:1})]),_:1}),l(S),l(z,null,{prepend:t(()=>[l(c,{class:"mr-2"},{default:t(()=>e[23]||(e[23]=[a("mdi-calendar-clock")])),_:1})]),default:t(()=>[l(R,null,{default:t(()=>e[24]||(e[24]=[a("Start Time")])),_:1}),l(O,null,{default:t(()=>[a(m(A(i.value.startTime,!0)),1)]),_:1})]),_:1}),l(S),l(z,null,{prepend:t(()=>[l(c,{class:"mr-2"},{default:t(()=>e[25]||(e[25]=[a("mdi-calendar-check")])),_:1})]),default:t(()=>[l(R,null,{default:t(()=>e[26]||(e[26]=[a("End Time")])),_:1}),l(O,null,{default:t(()=>[a(m(i.value.endTime?A(i.value.endTime,!0):"Running"),1)]),_:1})]),_:1}),l(S),l(z,null,{prepend:t(()=>[l(c,{class:"mr-2"},{default:t(()=>e[27]||(e[27]=[a("mdi-timer-outline")])),_:1})]),default:t(()=>[l(R,null,{default:t(()=>e[28]||(e[28]=[a("Duration")])),_:1}),l(O,null,{default:t(()=>[a(m(J(i.value.duration)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(T,{cols:"12",lg:"6"},{default:t(()=>[l(x,{variant:"outlined",class:"mb-4"},{default:t(()=>[l(N,{class:"text-subtitle-1 bg-grey-lighten-4"},{default:t(()=>[l(c,{start:""},{default:t(()=>e[29]||(e[29]=[a("mdi-chart-bar")])),_:1}),e[30]||(e[30]=a(" Performance Metrics "))]),_:1}),l(w,null,{default:t(()=>{var o;return[d("div",Ve,[d("div",he,[e[31]||(e[31]=d("span",{class:"text-body-2 font-weight-medium"},"Progress",-1)),d("span",Ae,m(Math.round(i.value.progressPercent||0))+"%",1)]),l(ve,{"model-value":i.value.status==="Running"?i.value.progressPercent||0:100,color:E(i.value.status),height:"10",rounded:"",striped:i.value.status==="Running"},null,8,["model-value","color","striped"])]),l(S,{class:"my-4"}),d("div",Fe,[l(c,{class:"mr-2"},{default:t(()=>e[32]||(e[32]=[a("mdi-database")])),_:1}),e[33]||(e[33]=d("span",{class:"text-subtitle-2 font-weight-bold"},"Rows Processed",-1))]),d("div",Ne,m(((o=i.value.rowsProcessed)==null?void 0:o.toLocaleString())||"0"),1),l(S,{class:"my-4"}),d("div",Re,[l(v,{size:"small",color:E(i.value.status),"text-color":"white"},{default:t(()=>[a(m(i.value.status),1)]),_:1},8,["color"]),d("span",Oe," ID: "+m(i.value.id),1)])]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(H,{value:"logs"},{default:t(()=>[l(w,null,{default:t(()=>[d("div",ze,[l(c,{class:"mr-2"},{default:t(()=>e[34]||(e[34]=[a("mdi-text-box-outline")])),_:1}),e[36]||(e[36]=d("div",{class:"text-subtitle-1 font-weight-bold"},"Execution Logs",-1)),l(u),l(s,{density:"compact",variant:"text",size:"small","prepend-icon":"mdi-content-copy",onClick:ae},{default:t(()=>e[35]||(e[35]=[a(" Copy ")])),_:1})]),l(x,{variant:"outlined",class:"logs-container custom-scrollbar"},{default:t(()=>[d("pre",$e,m(i.value.logs||"No logs available"),1)]),_:1})]),_:1})]),_:1}),l(H,{value:"timeline"},{default:t(()=>[l(w,null,{default:t(()=>[d("div",Me,[l(c,{class:"mr-2"},{default:t(()=>e[37]||(e[37]=[a("mdi-timeline")])),_:1}),e[38]||(e[38]=d("div",{class:"text-subtitle-1 font-weight-bold"},"Execution Timeline",-1))]),G().length?(b(),$("div",Be,[l(_e,{side:"end","line-color":"grey-lighten-1",class:"timeline-container"},{default:t(()=>[(b(!0),$(De,null,ke(G(),(o,Y)=>(b(),L(ge,{key:Y,"dot-color":o.color,size:(o.important,"x-small"),icon:o.important?o.icon:void 0,"icon-color":o.important?"white":void 0,class:"app-timeline-item"},{opposite:t(()=>[d("div",je,m(se(o.time)),1)]),default:t(()=>[l(x,{variant:"outlined",color:o.color+"-lighten-5",class:"app-timeline-card",density:"compact"},{default:t(()=>[l(N,{class:"text-subtitle-2 pb-1 pt-2 px-3 d-flex align-center"},{default:t(()=>[l(c,{color:o.color,size:"small",class:"mr-2"},{default:t(()=>[a(m(o.icon),1)]),_:2},1032,["color"]),d("span",Qe,m(o.title),1)]),_:2},1024),o.description?(b(),L(w,{key:0,class:"pt-0 pb-2 px-3"},{default:t(()=>[d("p",We,m(o.description),1)]),_:2},1024)):M("",!0)]),_:2},1032,["color"])]),_:2},1032,["dot-color","size","icon","icon-color"]))),128))]),_:1})])):(b(),$("div",Ue,[l(c,{size:"48",color:"grey-lighten-1",class:"mb-2"},{default:t(()=>e[39]||(e[39]=[a("mdi-timeline-clock")])),_:1}),e[40]||(e[40]=d("div",{class:"text-body-1 text-grey"},"No timeline events available",-1))]))]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(S),l(X,null,{default:t(()=>[l(u),l(s,{variant:"text",onClick:e[6]||(e[6]=o=>k.value=!1)},{default:t(()=>e[41]||(e[41]=[a(" Close ")])),_:1})]),_:1})]),_:1})):M("",!0)]),_:1},8,["modelValue"]),l(Z,{modelValue:C.value,"onUpdate:modelValue":e[9]||(e[9]=o=>C.value=o),"max-width":"400px"},{default:t(()=>[l(x,null,{default:t(()=>[l(N,{class:"text-h5"},{default:t(()=>e[42]||(e[42]=[a(" Cancel Execution ")])),_:1}),l(w,null,{default:t(()=>e[43]||(e[43]=[a(" Are you sure you want to cancel this pipeline execution? This will stop all ongoing processing. ")])),_:1}),l(X,null,{default:t(()=>[l(u),l(s,{variant:"text",onClick:e[8]||(e[8]=o=>C.value=!1)},{default:t(()=>e[44]||(e[44]=[a(" No ")])),_:1}),l(s,{color:"error",onClick:de,loading:B.value},{default:t(()=>e[45]||(e[45]=[a(" Yes, Cancel ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Ge=xe(He,[["__scopeId","data-v-54da9e06"]]);export{Ge as default};
