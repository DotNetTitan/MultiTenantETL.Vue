import{_ as Ve,u as Se,r,s as be,o as _e,q as De,c as D,a as C,b as a,d as n,w as t,n as we,e as p,f as m,t as V,k as Ce,h as S,g as J}from"./index-BvbqYwnB.js";const Te={class:"d-flex align-center mb-4"},ge={key:0},ke={key:1},xe={key:2},Ae={key:3},Ue={key:0,class:"d-flex flex-column align-center py-4"},Pe={class:"mt-4"},qe={key:1,class:"text-center py-4"},Ne={class:"mt-4 text-h6"},Fe={class:"mt-2"},Le={__name:"DataSourcesView",setup(Ie){const j=De();we();const W=Se(),Y=[{title:"Name",key:"name"},{title:"Type",key:"type",width:"120px"},{title:"Description",key:"description"},{title:"Created",key:"createdAt",width:"150px"},{title:"Actions",key:"actions",sortable:!1,width:"120px",align:"end"}],x=r(""),A=r("All"),B=r("name_asc"),h=r([{title:"All Types",value:"All"},{title:"Database",value:"Database"},{title:"File",value:"File"},{title:"API",value:"API"}]),ee=r([{title:"Name (A-Z)",value:"name_asc"},{title:"Name (Z-A)",value:"name_desc"},{title:"Created (Newest)",value:"created_desc"},{title:"Created (Oldest)",value:"created_asc"},{title:"Type",value:"type_asc"}]),f=r([]),ae=r(["Database","File","API"]),O=r(!1),E=r(!1),Q=r(!1),b=r(!1),T=r(!1),U=r(!1),P=r(null),X=r(null),q=r(!1),N=r(!1),g=r(!1),$=r(""),le=r(null),o=r(te()),Z=be(()=>o.value.requiresCredentials?{username:[s=>!!s||"Username is required"],password:[s=>!!s||"Password is required"]}:{username:[],password:[]});function te(){return{id:null,name:"",description:"",type:"Database",isSource:!0,isDestination:!0,requiresCredentials:!0,database:{provider:"SQL Server",server:"",port:"",databaseName:""},file:{storageType:"Local",path:"",fileType:"CSV",delimiter:","},api:{baseUrl:"",authType:"None",dataFormat:"JSON"},credentials:{username:"",password:"",apiKey:"",token:""}}}function oe(s){switch(s){case"Database":return"primary";case"File":return"success";case"API":return"info";default:return"grey"}}function se(s){return s?new Date(s).toLocaleString():"-"}async function w(){try{if(O.value=!0,await new Promise(i=>setTimeout(i,500)),f.value=[{id:"1",name:"SQL Server - Sales",description:"Main sales database",type:"Database",createdAt:new Date(Date.now()-30*24*60*60*1e3).toISOString(),database:{provider:"SQL Server",server:"sales-db.example.com",port:"1433",databaseName:"SalesDB"},isSource:!0,isDestination:!0,requiresCredentials:!0},{id:"2",name:"SFTP - Customer Files",description:"SFTP server containing customer data files",type:"File",createdAt:new Date(Date.now()-25*24*60*60*1e3).toISOString(),file:{storageType:"SFTP",path:"/customers/data",fileType:"CSV",delimiter:","},isSource:!0,isDestination:!1,requiresCredentials:!0},{id:"3",name:"ERP API",description:"REST API for the ERP system",type:"API",createdAt:new Date(Date.now()-20*24*60*60*1e3).toISOString(),api:{baseUrl:"https://erp.example.com/api/v1",authType:"Bearer Token",dataFormat:"JSON"},isSource:!0,isDestination:!0,requiresCredentials:!0},{id:"4",name:"Analytics DB",description:"PostgreSQL database for analytics data",type:"Database",createdAt:new Date(Date.now()-15*24*60*60*1e3).toISOString(),database:{provider:"PostgreSQL",server:"analytics-db.example.com",port:"5432",databaseName:"analytics"},isSource:!0,isDestination:!0,requiresCredentials:!0},{id:"5",name:"Data Warehouse",description:"Central data warehouse",type:"Database",createdAt:new Date(Date.now()-10*24*60*60*1e3).toISOString(),database:{provider:"SQL Server",server:"dw.example.com",port:"1433",databaseName:"DataWarehouse"},isSource:!0,isDestination:!0,requiresCredentials:!0}],x.value){const i=x.value.toLowerCase();f.value=f.value.filter(v=>v.name.toLowerCase().includes(i)||v.description.toLowerCase().includes(i))}A.value!=="All"&&(f.value=f.value.filter(i=>i.type===A.value));const[s,e]=B.value.split("_");f.value.sort((i,v)=>{let d=i[s],u=v[s];return s==="created"&&(d=new Date(i.createdAt).getTime(),u=new Date(v.createdAt).getTime()),e==="asc"?d>u?1:-1:d<u?1:-1})}catch(s){console.error("Error fetching data sources:",s)}finally{O.value=!1}}function ue(){o.value.type==="Database"?o.value.database={provider:"SQL Server",server:"",port:"",databaseName:""}:o.value.type==="File"?o.value.file={storageType:"Local",path:"",fileType:"CSV",delimiter:","}:o.value.type==="API"&&(o.value.api={baseUrl:"",authType:"None",dataFormat:"JSON"}),G()}function G(){o.value.requiresCredentials||(o.value.credentials={username:"",password:"",apiKey:"",token:""})}function re(s){o.value=JSON.parse(JSON.stringify(s)),b.value=!0}function ne(s){P.value=s,T.value=!0}async function ie(){try{Q.value=!0,await new Promise(e=>setTimeout(e,1e3));const s=f.value.findIndex(e=>e.id===P.value.id);s!==-1&&f.value.splice(s,1),T.value=!1,P.value=null}catch(s){console.error("Error deleting data source:",s)}finally{Q.value=!1}}async function H(){try{E.value=!0,await new Promise(s=>setTimeout(s,1e3)),b.value=!1,await w()}catch(s){console.error("Error saving data source:",s)}finally{E.value=!1}}async function de(s){try{X.value=s,U.value=!0,q.value=!0,N.value=!1,await new Promise(i=>setTimeout(i,2e3));const e=Math.random()>.3;g.value=e,$.value=e?`Successfully connected to ${s.name}`:`Failed to connect to ${s.name}. Please check your credentials and connection details.`,N.value=!0}catch(e){console.error("Error testing connection:",e),g.value=!1,$.value=`An error occurred: ${e.message}`,N.value=!0}finally{q.value=!1}}return _e(async()=>{await w(),j.query.action==="create"&&(b.value=!0),W.$subscribe(()=>{W.currentTenantId&&w()})}),(s,e)=>{const i=n("v-spacer"),v=n("v-btn"),d=n("v-text-field"),u=n("v-col"),y=n("v-select"),_=n("v-row"),me=n("v-chip"),F=n("v-icon"),ve=n("v-data-table"),L=n("v-card-text"),I=n("v-card"),R=n("v-card-title"),K=n("v-switch"),ce=n("v-divider"),pe=n("v-textarea"),fe=n("v-form"),M=n("v-card-actions"),z=n("v-dialog"),ye=n("v-progress-circular");return p(),D("div",null,[C("div",Te,[e[32]||(e[32]=C("h1",{class:"text-h4 mr-4"},"Data Sources",-1)),a(i),a(v,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=l=>b.value=!0)},{default:t(()=>e[31]||(e[31]=[m(" Create Data Source ")])),_:1})]),a(I,null,{default:t(()=>[a(L,null,{default:t(()=>[a(_,null,{default:t(()=>[a(u,{cols:"12",md:"4"},{default:t(()=>[a(d,{modelValue:x.value,"onUpdate:modelValue":[e[1]||(e[1]=l=>x.value=l),w],label:"Search Data Sources","prepend-inner-icon":"mdi-magnify",density:"compact","hide-details":"",class:"mb-4"},null,8,["modelValue"])]),_:1}),a(u,{cols:"12",md:"3"},{default:t(()=>[a(y,{modelValue:A.value,"onUpdate:modelValue":[e[2]||(e[2]=l=>A.value=l),w],label:"Type",items:h.value,density:"compact","hide-details":"",class:"mb-4"},null,8,["modelValue","items"])]),_:1}),a(u,{cols:"12",md:"3"},{default:t(()=>[a(y,{modelValue:B.value,"onUpdate:modelValue":[e[3]||(e[3]=l=>B.value=l),w],label:"Sort By",items:ee.value,density:"compact","hide-details":"",class:"mb-4"},null,8,["modelValue","items"])]),_:1})]),_:1}),a(ve,{headers:Y,items:f.value,loading:O.value,"items-per-page":10,class:"mt-2"},{"item.type":t(({item:l})=>[a(me,{color:oe(l.type),"text-color":"white",size:"small"},{default:t(()=>[m(V(l.type),1)]),_:2},1032,["color"])]),"item.createdAt":t(({item:l})=>[m(V(se(l.createdAt)),1)]),"item.actions":t(({item:l})=>[a(v,{icon:"",variant:"text",size:"small",onClick:k=>re(l),title:"Edit data source"},{default:t(()=>[a(F,null,{default:t(()=>e[33]||(e[33]=[m("mdi-pencil")])),_:1})]),_:2},1032,["onClick"]),a(v,{icon:"",variant:"text",size:"small",color:"success",onClick:k=>de(l),title:"Test connection"},{default:t(()=>[a(F,null,{default:t(()=>e[34]||(e[34]=[m("mdi-connection")])),_:1})]),_:2},1032,["onClick"]),a(v,{icon:"",variant:"text",size:"small",color:"error",onClick:k=>ne(l),title:"Delete data source"},{default:t(()=>[a(F,null,{default:t(()=>e[35]||(e[35]=[m("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items","loading"])]),_:1})]),_:1}),a(z,{modelValue:b.value,"onUpdate:modelValue":e[26]||(e[26]=l=>b.value=l),"max-width":"700px",persistent:""},{default:t(()=>[a(I,null,{default:t(()=>[a(R,null,{default:t(()=>[m(V(o.value.id?"Edit Data Source":"Create Data Source"),1)]),_:1}),a(L,null,{default:t(()=>[a(fe,{ref_key:"form",ref:le,onSubmit:Ce(H,["prevent"])},{default:t(()=>[a(_,null,{default:t(()=>[a(u,{cols:"12"},{default:t(()=>[a(d,{modelValue:o.value.name,"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.name=l),label:"Data Source Name",required:"",rules:[l=>!!l||"Name is required"]},null,8,["modelValue","rules"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(y,{modelValue:o.value.type,"onUpdate:modelValue":[e[5]||(e[5]=l=>o.value.type=l),ue],label:"Type",items:ae.value,rules:[l=>!!l||"Type is required"]},null,8,["modelValue","items","rules"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(K,{modelValue:o.value.isSource,"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.isSource=l),label:"Can be used as source","hide-details":""},null,8,["modelValue"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(K,{modelValue:o.value.isDestination,"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.isDestination=l),label:"Can be used as destination","hide-details":""},null,8,["modelValue"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(K,{modelValue:o.value.requiresCredentials,"onUpdate:modelValue":[e[8]||(e[8]=l=>o.value.requiresCredentials=l),G],label:"Requires credentials","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),o.value.type==="Database"?(p(),D("div",ge,[a(_,null,{default:t(()=>[a(u,{cols:"12",md:"6"},{default:t(()=>[a(y,{modelValue:o.value.database.provider,"onUpdate:modelValue":e[9]||(e[9]=l=>o.value.database.provider=l),label:"Database Provider",items:["SQL Server","MySQL","PostgreSQL","Oracle","SQLite"],rules:[l=>!!l||"Provider is required"]},null,8,["modelValue","rules"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(d,{modelValue:o.value.database.server,"onUpdate:modelValue":e[10]||(e[10]=l=>o.value.database.server=l),label:"Server/Host",rules:[l=>!!l||"Server is required"]},null,8,["modelValue","rules"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(d,{modelValue:o.value.database.port,"onUpdate:modelValue":e[11]||(e[11]=l=>o.value.database.port=l),label:"Port",type:"number"},null,8,["modelValue"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(d,{modelValue:o.value.database.databaseName,"onUpdate:modelValue":e[12]||(e[12]=l=>o.value.database.databaseName=l),label:"Database Name",rules:[l=>!!l||"Database name is required"]},null,8,["modelValue","rules"])]),_:1})]),_:1})])):S("",!0),o.value.type==="File"?(p(),D("div",ke,[a(_,null,{default:t(()=>[a(u,{cols:"12",md:"6"},{default:t(()=>[a(y,{modelValue:o.value.file.storageType,"onUpdate:modelValue":e[13]||(e[13]=l=>o.value.file.storageType=l),label:"Storage Type",items:["Local","SFTP","S3","Azure Blob","Google Cloud Storage"],rules:[l=>!!l||"Storage type is required"]},null,8,["modelValue","rules"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(d,{modelValue:o.value.file.path,"onUpdate:modelValue":e[14]||(e[14]=l=>o.value.file.path=l),label:"Path/Bucket",rules:[l=>!!l||"Path is required"]},null,8,["modelValue","rules"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(y,{modelValue:o.value.file.fileType,"onUpdate:modelValue":e[15]||(e[15]=l=>o.value.file.fileType=l),label:"File Type",items:["CSV","JSON","XML","Excel","Parquet","Avro"],rules:[l=>!!l||"File type is required"]},null,8,["modelValue","rules"])]),_:1}),o.value.file.fileType==="CSV"?(p(),J(u,{key:0,cols:"12",md:"6"},{default:t(()=>[a(d,{modelValue:o.value.file.delimiter,"onUpdate:modelValue":e[16]||(e[16]=l=>o.value.file.delimiter=l),label:"Delimiter",placeholder:","},null,8,["modelValue"])]),_:1})):S("",!0)]),_:1})])):S("",!0),o.value.type==="API"?(p(),D("div",xe,[a(_,null,{default:t(()=>[a(u,{cols:"12"},{default:t(()=>[a(d,{modelValue:o.value.api.baseUrl,"onUpdate:modelValue":e[17]||(e[17]=l=>o.value.api.baseUrl=l),label:"Base URL",rules:[l=>!!l||"Base URL is required"]},null,8,["modelValue","rules"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(y,{modelValue:o.value.api.authType,"onUpdate:modelValue":e[18]||(e[18]=l=>o.value.api.authType=l),label:"Authentication Type",items:["None","Basic","Bearer Token","API Key","OAuth2"]},null,8,["modelValue"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(y,{modelValue:o.value.api.dataFormat,"onUpdate:modelValue":e[19]||(e[19]=l=>o.value.api.dataFormat=l),label:"Data Format",items:["JSON","XML","CSV"],rules:[l=>!!l||"Data format is required"]},null,8,["modelValue","rules"])]),_:1})]),_:1})])):S("",!0),o.value.requiresCredentials?(p(),D("div",Ae,[a(ce,{class:"my-4"}),e[36]||(e[36]=C("div",{class:"text-subtitle-1 mb-2"},"Credentials",-1)),a(_,null,{default:t(()=>{var l,k;return[a(u,{cols:"12",md:"6"},{default:t(()=>[a(d,{modelValue:o.value.credentials.username,"onUpdate:modelValue":e[20]||(e[20]=c=>o.value.credentials.username=c),label:"Username",rules:Z.value.username},null,8,["modelValue","rules"])]),_:1}),a(u,{cols:"12",md:"6"},{default:t(()=>[a(d,{modelValue:o.value.credentials.password,"onUpdate:modelValue":e[21]||(e[21]=c=>o.value.credentials.password=c),label:"Password",type:"password",rules:Z.value.password},null,8,["modelValue","rules"])]),_:1}),((l=o.value.api)==null?void 0:l.authType)==="API Key"?(p(),J(u,{key:0,cols:"12"},{default:t(()=>[a(d,{modelValue:o.value.credentials.apiKey,"onUpdate:modelValue":e[22]||(e[22]=c=>o.value.credentials.apiKey=c),label:"API Key",rules:[c=>!!c||"API Key is required"]},null,8,["modelValue","rules"])]),_:1})):S("",!0),((k=o.value.api)==null?void 0:k.authType)==="Bearer Token"?(p(),J(u,{key:1,cols:"12"},{default:t(()=>[a(d,{modelValue:o.value.credentials.token,"onUpdate:modelValue":e[23]||(e[23]=c=>o.value.credentials.token=c),label:"Bearer Token",rules:[c=>!!c||"Token is required"]},null,8,["modelValue","rules"])]),_:1})):S("",!0)]}),_:1})])):S("",!0),a(_,null,{default:t(()=>[a(u,{cols:"12"},{default:t(()=>[a(pe,{modelValue:o.value.description,"onUpdate:modelValue":e[24]||(e[24]=l=>o.value.description=l),label:"Description",rows:"2"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),a(M,null,{default:t(()=>[a(i),a(v,{variant:"text",onClick:e[25]||(e[25]=l=>b.value=!1)},{default:t(()=>e[37]||(e[37]=[m(" Cancel ")])),_:1}),a(v,{color:"primary",onClick:H,loading:E.value},{default:t(()=>e[38]||(e[38]=[m(" Save ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(z,{modelValue:T.value,"onUpdate:modelValue":e[28]||(e[28]=l=>T.value=l),"max-width":"400px"},{default:t(()=>[a(I,null,{default:t(()=>[a(R,{class:"text-h5"},{default:t(()=>e[39]||(e[39]=[m(" Delete Data Source ")])),_:1}),a(L,null,{default:t(()=>{var l;return[m(' Are you sure you want to delete the data source "'+V((l=P.value)==null?void 0:l.name)+'"? This action cannot be undone. ',1)]}),_:1}),a(M,null,{default:t(()=>[a(i),a(v,{variant:"text",onClick:e[27]||(e[27]=l=>T.value=!1)},{default:t(()=>e[40]||(e[40]=[m(" Cancel ")])),_:1}),a(v,{color:"error",onClick:ie,loading:Q.value},{default:t(()=>e[41]||(e[41]=[m(" Delete ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(z,{modelValue:U.value,"onUpdate:modelValue":e[30]||(e[30]=l=>U.value=l),"max-width":"400px"},{default:t(()=>[a(I,null,{default:t(()=>[a(R,null,{default:t(()=>e[42]||(e[42]=[m(" Testing Connection ")])),_:1}),a(L,null,{default:t(()=>{var l;return[q.value?(p(),D("div",Ue,[a(ye,{indeterminate:"",size:"64",width:"4"}),C("div",Pe,"Testing connection to "+V((l=X.value)==null?void 0:l.name)+"...",1)])):N.value?(p(),D("div",qe,[a(F,{color:g.value?"success":"error",size:"64"},{default:t(()=>[m(V(g.value?"mdi-check-circle":"mdi-alert-circle"),1)]),_:1},8,["color"]),C("div",Ne,V(g.value?"Connection Successful":"Connection Failed"),1),C("div",Fe,V($.value),1)])):S("",!0)]}),_:1}),a(M,null,{default:t(()=>[a(i),a(v,{variant:"text",onClick:e[29]||(e[29]=l=>U.value=!1),disabled:q.value},{default:t(()=>e[43]||(e[43]=[m(" Close ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Oe=Ve(Le,[["__scopeId","data-v-2d3afd61"]]);export{Oe as default};
